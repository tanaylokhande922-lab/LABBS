{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the CampusConnect application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "The name displayed to other users."
        },
        "profilePictureUrl": {
          "type": "string",
          "description": "URL of the user's profile picture, stored in Firebase Storage.",
          "format": "uri"
        },
        "selectedPath": {
          "type": "string",
          "description": "The user's chosen path (e.g., 1st Year, 2nd Year, GATE, UPSC)."
        }
      },
      "required": [
        "id",
        "email"
      ]
    },
    "Resource": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Resource",
      "type": "object",
      "description": "Represents a learning resource available in the library.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Resource entity."
        },
        "pathId": {
          "type": "string",
          "description": "Reference to Path. (Relationship: Path 1:N Resource)"
        },
        "title": {
          "type": "string",
          "description": "Title of the resource."
        },
        "description": {
          "type": "string",
          "description": "A brief summary or description of the resource."
        },
        "fileUrl": {
          "type": "string",
          "description": "URL of the resource file stored in Firebase Storage.",
          "format": "uri"
        },
        "resourceType": {
          "type": "string",
          "description": "Type of resource (e.g., Syllabus, Question Paper, Book PDF)."
        }
      },
      "required": [
        "id",
        "pathId",
        "title",
        "fileUrl",
        "resourceType"
      ]
    },
    "Path": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Path",
      "type": "object",
      "description": "Represents a learning path (e.g., 1st Year, 2nd Year, GATE, UPSC).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Path entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the learning path (e.g., '1st Year')."
        },
        "description": {
          "type": "string",
          "description": "A brief description of the learning path."
        }
      },
      "required": [
        "id",
        "name"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. Accessible only to the authenticated user with matching userId.  Path-based ownership.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/paths/{pathId}",
        "definition": {
          "entityName": "Path",
          "schema": {
            "$ref": "#/backend/entities/Path"
          },
          "description": "Stores information about learning paths (e.g., 1st Year, 2nd Year).  Accessible to all authenticated users.",
          "params": [
            {
              "name": "pathId",
              "description": "The unique identifier for the learning path."
            }
          ]
        }
      },
      {
        "path": "/paths/{pathId}/resources/{resourceId}",
        "definition": {
          "entityName": "Resource",
          "schema": {
            "$ref": "#/backend/entities/Resource"
          },
          "description": "Stores learning resources associated with a specific path. Accessible to all authenticated users.  Authorization independence is ensured as access to the resources is granted through the parent path, not through resource specific roles.",
          "params": [
            {
              "name": "pathId",
              "description": "The unique identifier for the learning path."
            },
            {
              "name": "resourceId",
              "description": "The unique identifier for the learning resource."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to facilitate a college library website, CampusConnect. It prioritizes security, scalability, and debuggability, focusing on authorization independence and clear access patterns.  The design addresses the initial 'auth/configuration-not-found' error by ensuring Firebase is initialized correctly and consistently across all modules. \n\n**Authorization Independence:** Authorization is enforced via path-based ownership for user profiles and a hierarchical path structure for paths and resources.  This eliminates the need for `get()` calls in security rules, allowing atomic operations and easier debugging. For example, resource documents are stored in subcollections under the 'paths' collection. Access control is determined directly by the path.  This eliminates the need to fetch parent document data for authorization. Since no collaborative documents are present in the current feature set (no shared documents or data) the more complex Membership Map strategy is not needed. Should that requirement emerge in the future, the membership map can be implemented on a per-document basis.\n\n**Structural Segregation:**  Data with different access requirements are segregated into distinct collections. User profiles are stored under `/users/{userId}`, ensuring private data is only accessible to the respective user. Paths and Resources are stored under `/paths/{pathId}/resources/{resourceId}`, granting access to all authenticated users.\n\n**QAPs (Rules are not Filters):** The structure supports secure `list` operations. Listing resources within a specific path is secure because the rules can verify that the user is authenticated.\n\n**Addressing the 'auth/configuration-not-found' error:** The provided code snippets emphasize initializing Firebase only once in `firebase.js` and importing the initialized instances (`auth`, `db`, `storage`) in other modules. This prevents multiple initializations, which can lead to the 'auth/configuration-not-found' error."
  }
}